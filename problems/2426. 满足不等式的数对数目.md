
## 2426. æ»¡è¶³ä¸ç­‰å¼çš„æ•°å¯¹æ•°ç›®

ç»™ä½ ä¸¤ä¸ªä¸‹æ ‡ä» 0 å¼€å§‹çš„æ•´æ•°æ•°ç»„ `nums1` å’Œ `nums2` ï¼Œä¸¤ä¸ªæ•°ç»„çš„å¤§å°éƒ½ä¸º `n` ï¼ŒåŒæ—¶ç»™ä½ ä¸€ä¸ªæ•´æ•° `diff` ï¼Œç»Ÿè®¡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„ æ•°å¯¹ `(i, j)` ï¼š

* `0 <= i < j <= n - 1` ä¸”

* `nums1[i] - nums1[j] <= nums2[i] - nums2[j] + diff`.
è¯·ä½ è¿”å›æ»¡è¶³æ¡ä»¶çš„ æ•°å¯¹æ•°ç›® ã€‚



<br>

### é¢˜ç›®é“¾æ¥

| é¢˜å· |  é¢˜è§£ | éš¾åº¦ |
| :-----| :---- | :----: |
| [2426. æ»¡è¶³ä¸ç­‰å¼çš„æ•°å¯¹æ•°ç›®](https://leetcode.cn/problems/number-of-pairs-satisfying-inequality/description/) |  [ã€ ä¸ç­‰å¼å˜æ¢ ã€è®¡ç®—å·¦ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°ï¼ˆé™„å¤šç§è§£æ³•å‚è€ƒï¼‰](https://leetcode.cn/problems/number-of-pairs-satisfying-inequality/solutions/1863361/by-flix-vuue/) | <font color="red"> å›°éš¾ </font> |

<br>





### è§£é¢˜æ€è·¯

**å…³é”®ç‚¹ï¼šç§»é¡¹**
é€šè¿‡ç§»é¡¹ï¼Œå¯å°† 
$$nums1[i] - nums1[j] \leq nums2[i] - nums2[j] + diff , \quad\quad\quad (1)$$
å˜æ¢ä¸º 
$$nums1[i] - nums2[i] \leq nums1[j] - nums2[j] + diff .  \quad\quad\quad (2)$$



æ„é€ ä¸€ä¸ªæ–°çš„æ•°ç»„ $nums$ï¼Œä½¿å¾—å…¶ä¸­çš„å…ƒç´  $nums[i] = nums1[i] - nums2[i]$ï¼Œé‚£ä¹ˆå¼ $(2)$ ç­‰ä»·äºï¼š

$$nums[i] \leq nums[j] + diff . \quad\quad\quad(3) $$

ä¹Ÿå³æ˜¯å¯¹äºæ¯ä¸ª $nums[j]$ï¼Œæˆ‘ä»¬æ±‚å– $j$ ä½ç½®ä¹‹å‰ï¼ˆå·¦ä¾§ğŸ«²ï¼‰çš„å…ƒç´ ä¸­æ»¡è¶³ $nums[i] <= nums[j] + diff$ çš„å…ƒç´ ä¸ªæ•°ï¼ˆå…¶ä¸­ $0 \leq i < j \leq n - 1$ï¼‰ã€‚è¿™ä¸é¢˜ç›® [ã€315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°ã€‘](https://leetcode.cn/problems/count-of-smaller-numbers-after-self/) å¼‚æ›²åŒå·¥ã€‚

è‡³æ­¤ï¼Œé—®é¢˜å¾—åˆ°äº†ç®€åŒ–ï¼Œæ±‚è§£æ–¹æ¡ˆä¹Ÿå‘¼ä¹‹æ¬²å‡ºã€‚

---

å¯å‚è€ƒé¢˜ç›®[ã€315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°ã€‘](https://leetcode.cn/problems/count-of-smaller-numbers-after-self/)çš„**å¤šç§è§£æ³•**ï¼š

| é¢˜å· |  é¢˜è§£ | éš¾åº¦ |
| :-----| :---- | :----: |
| [315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°](https://leetcode.cn/problems/count-of-smaller-numbers-after-self/) |  [ ã€ 4ç§è§£æ³•ä¸€ç½‘æ‰“å°½ ã€ æœ‰åºæ•°ç»„ã€å½’å¹¶æ’åºã€æ ‘çŠ¶æ•°ç»„å’Œçº¿æ®µæ ‘çš„å®ç°åŠæ³¨é‡Š](https://leetcode.cn/problems/count-of-smaller-numbers-after-self/solution/4chong-jie-fa-yi-wang-da-jin-pai-xu-shu-5vvds/) | å›°éš¾ |

---

<br>

**æœ‰åºæ•°ç»„å®ç°ï¼š**
å…·ä½“å®ç°ä¸­ï¼Œå¯ç»´æŠ¤ä¸€ä¸ª**æœ‰åº**æ•°ç»„ $sl$ï¼ˆå­˜å‚¨ $nums[i]-diff$ï¼‰ï¼š
åœ¨æšä¸¾åˆ° $nums[j]$ æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦è®¡ç®— $sl$ ä¸­ **å°äºç­‰äº** $nums[j]$ çš„å…ƒç´ ä¸ªæ•°ï¼ˆå¯é€šè¿‡**äºŒåˆ†æŸ¥æ‰¾**å¿«é€Ÿå®ç°ï¼‰å¹¶è®¡å…¥ç­”æ¡ˆä¸­ï¼Œå†å°† $nums[j]-diff$ å­˜å…¥ $sl$ ä¸­ä»¥ä¾¿åç»­æŸ¥æ‰¾ã€‚

> å…¶ä»–æ»¡è¶³å•æ¬¡ $O(\log n)$ æ·»åŠ /æŸ¥æ‰¾ å…ƒç´ çš„æ•°æ®ç»“æ„ï¼ˆå¦‚æ ‘çŠ¶æ•°ç»„ã€çº¿æ®µæ ‘ï¼‰ä¹ŸåŒæ ·å¯è¡Œï¼Œå‚ç…§ä¸Šè¡¨ä¸­çš„ [315. è®¡ç®—å³ä¾§å°äºå½“å‰å…ƒç´ çš„ä¸ªæ•°](https://leetcode.cn/problems/count-of-smaller-numbers-after-self/) ã€‚

<br>


### ä»£ç 
```Python []
from sortedcontainers import SortedList
class Solution:
    def numberOfPairs(self, nums1: List[int], nums2: List[int], diff: int) -> int:
        nums = [x-y for (x,y) in zip(nums1, nums2)]
        
        sl = SortedList()                   # ç»´æŠ¤ä¸€ä¸ªæœ‰åºé›†åˆ
        ans = 0
        for num in nums:
            i = sl.bisect_right(num+diff)   # äºŒåˆ†æŸ¥æ‰¾ï¼šslä¸­<=num+diffçš„å…ƒç´ æœ‰å¤šå°‘ä¸ªï¼Ÿ
            ans += i
            sl.add(num)                     # numæ·»åŠ åˆ°æœ‰åºæ•°ç»„ä¸­[å¤æ‚åº¦ï¼šO(logn)]
        
        return ans


```